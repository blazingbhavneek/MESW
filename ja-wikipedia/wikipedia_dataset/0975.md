# 位相偏移変調

位相偏移変調（いそうへんいへんちょう）もしくは位相シフトキーイング（英語: phase-shift keying, PSK）は、基準信号（搬送波）の位相を変調することによって、データを伝送する、デジタル変調方式である。

概要
PSKでは、基本波の位相を不連続に変化させることにより、デジタルデータを表現する。例えば、４種の位相を用いて表現する時（QPSK）、一つの位相には２ビット（00、01、10、11）が割り当てられる。
位相に割り当てられる各々のビットパターンをシンボルと呼ぶ。
復調器は、変調において使用されたシンボルと位相の組み合わせに基づいて設計される。まず、受信信号の位相を明らかにし、次に、各位相が表現しているシンボルを基に、ビット列を組み立てることで元のデータを復元する。
受信信号と基準信号の位相差により、デジタルデータを表現する方式を、coherent phase-shift keying (CPSK)と呼ぶ。この場合、復調器は、基準信号と同期していなければならない。
受信信号における、位相の相対的な変化の量によってデジタルデータを表現する方式を、差動（差分）位相偏移変調（DPSK）と呼ぶ。この場合、復調器は基準信号と同期する必要がないため、比較的実装が容易となるが、復調時の誤りが生じやすくなるため、誤り訂正などによる補正が重要である。

序論
デジタル信号の伝送で使用される、主なデジタル変調技術は、次の三種類である。

振幅偏移変調
周波数偏移変調
位相偏移変調
全て、データ信号に応じて、基準信号、搬送波（通常シヌソイド）の一部の特性を変化させることによってデータを伝送する。
PSKの場合、データ信号を表すために位相を変化させる。
この様にPSKで信号の位相を利用するためには、以下の二つの方法がある。

情報を伝達する信号の位相自体を見る方法。この場合、復調器は受信信号の位相を比較する基準信号を持たなければならない。
情報を伝達する信号の位相の「変化」を見る方法。すなわち、位相の差を判断する。この方式の一部の構成では、基準搬送波を必要としない。

PSKを表現する便利な方法に、信号空間ダイヤグラムがある。
これは、同相の信号を実数軸に、直角位相の信号を虚数軸にとったガウス平面上に信号点を示す方法である。
垂直な軸におけるそのような表現は、簡単な実現に適している。
同相軸に沿ったそれぞれの信号点の振幅はコサイン（またはサイン）波を変調し、さらに直角位相軸に沿った振幅はサイン（またはコサイン）波を変調する。
PSKでは、選ばれる信号点は、通常円のまわりに、均一の角度間隔で配置される。
これにより、隣接点間の位相距離を最大にし、干渉に対する耐性を最大にする。
それらの点は全て同一のエネルギーで送信が可能であるように、円上に配置される。
この方法によって、それらが表す複素数のノルムは等しくなり、コサインとサイン波に必要となる振幅も同じになる。
いくつの位相を用いても良いが、一般的な例として、二つの位相を使用する、二位相偏移変調や、4つの位相を使用する四位相偏移変調が存在する。
伝達されるデータは通常バイナリであるので、PSKは通常、2の累乗である信号点の数で設計される。

定義
誤り率を数学的に計算するためには、いくつかの定義が必要となる。

  
    
      
        
          E
          
            b
          
        
      
    
    {\displaystyle E_{b}}
  
 = 1ビットあたりのエネルギー

  
    
      
        
          E
          
            s
          
        
      
    
    {\displaystyle E_{s}}
  
 = 1シンボルあたりのエネルギー = 
  
    
      
        k
        
          E
          
            b
          
        
      
    
    {\displaystyle kE_{b}}
  
 1シンボルあたりkビットのエネルギー

  
    
      
        
          T
          
            b
          
        
      
    
    {\displaystyle T_{b}}
  
 = ビット間隔

  
    
      
        
          T
          
            s
          
        
      
    
    {\displaystyle T_{s}}
  
 = シンボル間隔

  
    
      
        
          N
          
            0
          
        
        
          /
        
        2
      
    
    {\displaystyle N_{0}/2}
  
= ノイズ電力スペクトル密度( W / Hz )

  
    
      
        
          P
          
            b
          
        
      
    
    {\displaystyle P_{b}}
  
 = 符号誤り率

  
    
      
        
          P
          
            s
          
        
      
    
    {\displaystyle P_{s}}
  
 = シンボル誤り率

Q(x)は、平均がゼロ、分散が１となるガウスの確率密度関数でランダムな過程から得られた単一のサンプルがx以上である確率である。
それは相補ガウスエラー関数の規格化された形である。
ここで示した誤り率は加算性白色ガウス雑音(AWGN)のものである。
この誤り率はフェージングのものよりは低く、理論的な比較に適している。

用途
比較対象として挙げられるQAMと比較すると、PSKはその単純さのため、既存の技術を用いて広く利用されている。
最も一般的な無線LAN規格IEEE 802.11bは、要求されるデータ転送速度に応じて、様々なPSKを組み合わせて利用している。
1Mbit/sの基本速度では、DBPSKを使用し、拡張された2Mbit/sの速度では、DQPSKが使われ、5.5 Mbit/s と11Mbit/sのフルレートでは、QPSKが利用される。このとき、CCK（Complementary Code Keying）も併用される。
高速無線LAN規格IEEE 802.11gでは、6, 9, 12, 18, 24, 36, 48 そして 54 Mbit/sの8つのデータ転送速度を持つ。6、9Mbit/sのモードではBPSKが、12、18Mbit/sのモードではQPSKが、残りの4つの高速なモードでは、QAMが利用される。
その単純さのため、BPSKは低コストの受動的な送信機に利用され、ISO14443を満たすRFIDに利用されている。このRFIDは、生体認証パスポート、クレジットカードやその他の用途に利用されている。
Bluetooth 2は、低いレート(2 Mbit/s)ではπ / 4-DQPSKが、2台の装置のリンクが十分に強いとき高いレート(3 Mbit/s)では8-DPSKが使われる。Bluetooth 1は、ガウス最小偏移変調で変調され、バージョン2では、どちらの変調方式を選択するかにより、より高速の転送速度を出すことができる。

二位相偏移変調 (BPSK)
BPSK（英語: binary phase-shift keying）はPSKで最も単純な形式である。
これは180°分離された2つの位相を使い、「2-PSK」とも呼ばれる。
信号点がどこに置かれるかは必ずしも特に重要ではなく、そしてこの形ではそれらは実軸において0°と180°に示される。
この方式は、誤った内容に復号されるには、致命的なほどの妨害波が必要であるため、全てのPSKの中で最も強力なものである。しかし、図にあるように1シンボルあたり1ビットのみの変調が可能であるため、帯域幅が限定されている場合高速のデータ転送には不適切である。

AWGN環境下におけるBPSKの符号誤り率（BER）を示すと以下のとおりになる：

1シンボルにつき1ビットだけなので、これはシンボル誤り率（SER）でもある。
通信伝送路によってもたらされる任意の位相シフトがある状態で、復調器はどの信号点がどれかを伝えることができない。
そのため、データは変調前にしばしば特異的に符号化される。

計算
バイナリデータは、以下の信号でしばしば伝達される：

従って、信号スペース（signal space）は一つの基底関数によって表すことができる。

1は
  
    
      
        
          
            
              E
              
                b
              
            
          
        
        ϕ
        (
        t
        )
      
    
    {\displaystyle {\sqrt {E_{b}}}\phi (t)}
  
によって表現され、0は
  
    
      
        −
        
          
            
              E
              
                b
              
            
          
        
        ϕ
        (
        t
        )
      
    
    {\displaystyle -{\sqrt {E_{b}}}\phi (t)}
  
によって表現される。
この割り当てはもちろん、任意である。

四位相偏移変調 (QPSK)
quaternary または quadriphase PSK、 4-PSK、4-QAMとも言われる。
QPSKは信号空間ダイヤグラムで4点使用し、円状に配置される。
4段階の位相を用いて、QPSKは1シンボルにつき2ビットを符号化することができる。さらにグレイ符号を用いて符号誤り率を小さくできる。
QPSKのビット誤り率は、BPSKと同じになる

しかしながら、BPSKと同じビット誤り率を達成するためには、電力を2倍必要とする。（2ビットが同時に送られるため）
シンボル誤り率は次のように与えられる：

もし、信号対雑音比が高い（実用的なQPSKシステムのために必要であるような）ならば、シンボル誤り率は次のように近似される：

差動(差分)位相偏移変調 (DPSK)
差動符号化
差動位相偏移変調(DPSK)は搬送波の位相を変更することでデータを伝達する一般的な形式の位相変調である。BPSKとQPSKで説明したように信号が通過する通信路で何らかの効果によりコンステレーションが回転すると位相が不明確になる。この問題はデータを使用して位相を「設定」するのではなく「変更」することで解決することができる。
例えば、差動符号化されたBPSKでは、現在の位相に180°を加えることでバイナリ"1"を送信でき、0°を加えることで"0"を送信できるSDPSK。DPSKの変形は対称差動位相偏移変調(SDPSK)であり、この場合、"1"の場合は+90°、"0"の場合は−90°である。
差動符号化されたQPSK(DQPSK)では、位相シフトは0°、90°、180°、−90°でありデータ"00"、"01"、"11"、"10"に対応する。この種の符号化は非差動PSKと場合と同じ方法で復調できるが、位相のあいまいさは無視できる。したがって、各受信符号はコンステレーションのM点の1つに復調され、コンパレータはこの受信信号と前の信号との間の位相差を計算する。差は上記のようにデータを符号化する。対称差動四位相偏移変調(SDQPSK)はDQPSKに似ているが、符号が対称的であり、位相シフト値は−135°, −45°, +45°,+135°である。
上記のDBPSKとDQPSKの両方の変調信号を以下に示す。この図では「信号が0位相で始まる」と仮定されており、
  
    
      
        t
        =
        0
      
    
    {\displaystyle t=0}
  
で両方の信号に位相シフトがある。

解析により、差動符号化は通常の
  
    
      
        M
      
    
    {\displaystyle M}
  
-PSKと比較してエラー率が約2倍になるが、これは
  
    
      
        
          E
          
            b
          
        
        
          /
        
        
          N
          
            0
          
        
      
    
    {\displaystyle E_{b}/N_{0}}
  
を少し増やすだけで解決できる可能性がある。さらに、この解析（および以下のグラフ結果）は改悪が加算性白色ガウス雑音(AWGN)のみであるシステムに基づいている。しかし、通信システムの送信機と受信機の間の物理チャネルもある。このチャネルは一般的にPSK信号に未知の位相シフトを導入する。これらの場合、微分スキームは正確な位相情報に依存する通常のスキームよりも「優れた」エラー率を生み出すことがある。
DPSKの最も一般的な応用の1つは
  
    
      
        π
        
          /
        
        4
      
    
    {\displaystyle \pi /4}
  
-DQPSKと8-DPSKが実装されたBluetooth規格である。

復調
差分符号化された信号の場合、復調の明白な代替方法がある。通常のように復調しキャリア位相のあいまいさを無視する代わりに、2つの連続する受信符号間の位相が比較され、データが何でなくてはならなかったのかを決定するために使用される。この方法で差分符号化が使用される場合、このスキームは差動位相偏移変調(DPSK)と呼ばれる。これは受信時に受信符号が1つずつコンステレーション点に復号されるのではなく直接互いに比較されるため、単に差動符号化されたPSKと微妙に異なることに注意。
受信符号をk番目のタイムスロット
  
    
      
        
          r
          
            k
          
        
      
    
    {\displaystyle r_{k}}
  
で呼び出し、位相を
  
    
      
        
          ϕ
          
            k
          
        
      
    
    {\displaystyle \phi _{k}}
  
にする。一般性を失うことなく搬送波の位相が0であると仮定する。加算性白色ガウス雑音(AWGN)項を
  
    
      
        
          n
          
            k
          
        
      
    
    {\displaystyle n_{k}}
  
として示すと、次式

  
    
      
        
          r
          
            k
          
        
        =
        
          
            
              E
              
                s
              
            
          
        
        
          e
          
            j
            
              ϕ
              
                k
              
            
          
        
        +
        
          n
          
            k
          
        
        .
      
    
    {\displaystyle r_{k}={\sqrt {E_{s}}}e^{j\phi _{k}}+n_{k}.}
  

となる。(k-1)番目の符号とk番目の符号の決定変数は
  
    
      
        
          r
          
            k
          
        
      
    
    {\displaystyle r_{k}}
  
と
  
    
      
        
          r
          
            k
            −
            1
          
        
      
    
    {\displaystyle r_{k-1}}
  
の位相差である。つまり、
  
    
      
        
          r
          
            k
          
        
      
    
    {\displaystyle r_{k}}
  
が
  
    
      
        
          r
          
            k
            −
            1
          
        
      
    
    {\displaystyle r_{k-1}}
  
に投影されると、結果として複素数の位相が得られる。

  
    
      
        
          r
          
            k
          
        
        
          r
          
            k
            −
            1
          
          
            ∗
          
        
        =
        
          E
          
            s
          
        
        
          e
          
            j
            
              (
              
                
                  φ
                  
                    k
                  
                
                −
                
                  φ
                  
                    k
                    −
                    1
                  
                
              
              )
            
          
        
        +
        
          
            
              E
              
                s
              
            
          
        
        
          e
          
            j
            
              φ
              
                k
              
            
          
        
        
          n
          
            k
            −
            1
          
          
            ∗
          
        
        +
        
          
            
              E
              
                s
              
            
          
        
        
          e
          
            −
            j
            
              φ
              
                k
                −
                1
              
            
          
        
        
          n
          
            k
          
        
        +
        
          n
          
            k
          
        
        
          n
          
            k
            −
            1
          
          
            ∗
          
        
      
    
    {\displaystyle r_{k}r_{k-1}^{*}=E_{s}e^{j\left(\varphi _{k}-\varphi _{k-1}\right)}+{\sqrt {E_{s}}}e^{j\varphi _{k}}n_{k-1}^{*}+{\sqrt {E_{s}}}e^{-j\varphi _{k-1}}n_{k}+n_{k}n_{k-1}^{*}}
  

上付きの*は複素共役を表す。ノイズがない場合、この位相は
  
    
      
        
          ϕ
          
            k
          
        
        −
        
          ϕ
          
            k
            −
            1
          
        
      
    
    {\displaystyle \phi _{k}-\phi _{k-1}}
  
であり、送信されたデータを決定するために使用できる2つの受信信号の間の位相シフトである。
DPSKのエラーの確率は、一般に計算が困難であるがDBPSKの場合は次のようになる。

  
    
      
        
          P
          
            b
          
        
        =
        
          
            1
            2
          
        
        
          e
          
            −
            
              
                
                  E
                  
                    b
                  
                
                
                  N
                  
                    0
                  
                
              
            
          
        
        ,
      
    
    {\displaystyle P_{b}={\frac {1}{2}}e^{-{\frac {E_{b}}{N_{0}}}},}
  

数値で評価すると、特に
  
    
      
        
          E
          
            b
          
        
        
          /
        
        
          N
          
            0
          
        
      
    
    {\displaystyle E_{b}/N_{0}}
  
の値が高い場合に、通常のBPSKよりわずかに悪いだけである。
DPSKを使用すると、複雑かもしれないキャリア回復スキームにより正確な位相推定を行う必要がなくなり、通常のPSKの魅力的な代替手段となる。
光通信では、データを差動方式でレーザーの位相に変調できる。変調は連続波を放出するレーザーと、電気バイナリデータを受信するマッハ・ツェンダー干渉計である。BPSKの場合、レーザーはバイナリの'1'のフィールドを変更せずに送信し、'0'の極性は逆にする。復調器は1ビットを遅延させる遅延干渉計で構成されているため、2ビットを同時に比較できる。その後の処理では、フォトダイオードを使用して光学場を電流に変換し、情報を元の状態に戻る。
右のグラフではDBPSKとDQPSKのビット誤り率を差動ではないものと比較している。DBPSKを使用することによる損失はBPSKを使用する通信システムでしばしば使用される複雑さの低減と比較して十分小さい。ただしDQPSKの場合、通常のQPSKと比較して動作の損失が大きく、システム設計者はこれと複雑さの低減とのバランスをとる必要がある。

例: 差動符号化BPSK
k番目のタイムスロットで変調されるビット
  
    
      
        
          b
          
            k
          
        
      
    
    {\displaystyle b_{k}}
  
、差動符号化ビット
  
    
      
        
          e
          
            k
          
        
      
    
    {\displaystyle e_{k}}
  
、結果得られる変調信号
  
    
      
        
          m
          
            k
          
        
        (
        t
        )
      
    
    {\displaystyle m_{k}(t)}
  
を呼び出す。コンステレーション図は符号を±1（BPSKでは）に配置すると仮定する。差動符号化器は以下を生成する。

  
    
      
        
        
          e
          
            k
          
        
        =
        
          e
          
            k
            −
            1
          
        
        ⊕
        
          b
          
            k
          
        
      
    
    {\displaystyle \,e_{k}=e_{k-1}\oplus b_{k}}
  

  
    
      
        ⊕
        

        
      
    
    {\displaystyle \oplus {}}
  
は二進法またはモジュロ2の加算を示す。

そのため、
  
    
      
        
          b
          
            k
          
        
      
    
    {\displaystyle b_{k}}
  
はバイナリ"1"である場合、
  
    
      
        
          e
          
            k
          
        
      
    
    {\displaystyle e_{k}}
  
は状態を変更するだけである（バイナリ"0"からバイナリ"1"に、またはバイナリ"1"からバイナリ"0"に）。それ以外の場合は以前の状態のままである。これが上記の差動符号化BPSKの説明である。
受信信号は復調され、
  
    
      
        
          e
          
            k
          
        
        =
        ±
        1
      
    
    {\displaystyle e_{k}=\pm 1}
  
が生成され、差分復号器が符号化手順を逆にして

  
    
      
        
          b
          
            k
          
        
        =
        
          e
          
            k
          
        
        ⊕
        
          e
          
            k
            −
            1
          
        
        ,
      
    
    {\displaystyle b_{k}=e_{k}\oplus e_{k-1},}
  

を生成する（バイナリ減算はバイナリ加算と同じであるため）。
したがって、
  
    
      
        
          e
          
            k
          
        
      
    
    {\displaystyle e_{k}}
  
と
  
    
      
        
          e
          
            k
            −
            1
          
        
      
    
    {\displaystyle e_{k-1}}
  
が異なる場合
  
    
      
        
          b
          
            k
          
        
        =
        1
      
    
    {\displaystyle b_{k}=1}
  
であり、同じ場合
  
    
      
        
          b
          
            k
          
        
        =
        0
      
    
    {\displaystyle b_{k}=0}
  
である。したがって、
  
    
      
        
          e
          
            k
          
        
      
    
    {\displaystyle e_{k}}
  
と
  
    
      
        
          e
          
            k
            −
            1
          
        
      
    
    {\displaystyle e_{k-1}}
  
が「反転」していても
  
    
      
        
          b
          
            k
          
        
      
    
    {\displaystyle b_{k}}
  
は正しく復号される。よって180°の位相のあいまいさは問題にならない。
他のPSK変調の差動スキームも同様の方法で考案できる。DPSKの波形は2つのスキーム間の唯一の変更が受信器で行われるため、上記で与えられた差動符号化PSKの波形と同じである。
この例のBER曲線は右側で通常のBPSKと比較される。上で述べたように、エラー率はおよそ2倍になるが、これを解決するために
  
    
      
        
          E
          
            b
          
        
        
          /
        
        
          N
          
            0
          
        
      
    
    {\displaystyle E_{b}/N_{0}}
  
に必要な増加量はわずかである。しかし、符号化システムの差動変調を乗り切るために必要な
  
    
      
        
          E
          
            b
          
        
        
          /
        
        
          N
          
            0
          
        
      
    
    {\displaystyle E_{b}/N_{0}}
  
の増加は大きく、通常は約3 dBである。動作の低下は非コヒーレント伝送の結果である。この場合は位相の追跡が完全に無視されていることを示す。

脚注
関連項目
変調方式
デジタル変調
PSK31
# 直角位相振幅変調

直交位相振幅変調（ちょっこういそうしんぷくへんちょう、英: quadrature amplitude modulation : QAM）は、互いに独立な2つの搬送波（すなわち同相(in-phase)搬送波及び直交位相(quadrature)搬送波）の振幅を変更・調整することによってデータを伝達する変調方式である。
これらの2つの搬送波（通常はシヌソイド）は、90°により互いに直交位相関係にある。

表題は直角位相振幅変調となっているが、総務省をはじめとして、直交振幅変調（ちょっこうしんぷくへんちょう）と呼ばれる。

概要
ほかの変調方式同様、QAM変調も、データ信号に応じて搬送波信号または搬送波（通常、シヌソイド）の何らかの局面を変更する事によって、データを伝達する。
QAM変調の場合、データ信号を表すために、直角位相関係にある2つの搬送波の振幅が変わる。
QAM変調は、振幅偏移変調(ASK)と位相偏移変調(PSK)の組み合わせである振幅位相偏移変調(APSK)の一つである。

アナログQAM
QAM変調で2つの信号を伝送した時の、送信信号は以下のようになる。

  
    
      
         
        s
        (
        t
        )
        =
        I
        (
        t
        )
        cos
        ⁡
        (
        2
        π
        
          f
          
            0
          
        
        t
        )
        +
        Q
        (
        t
        )
        sin
        ⁡
        (
        2
        π
        
          f
          
            0
          
        
        t
        )
      
    
    {\displaystyle \ s(t)=I(t)\cos(2\pi f_{0}t)+Q(t)\sin(2\pi f_{0}t)}
  
,

  
    
      
        I
        (
        t
        )
      
    
    {\displaystyle I(t)}
  
と
  
    
      
        Q
        (
        t
        )
      
    
    {\displaystyle Q(t)}
  
は変調信号で、
  
    
      
        
          f
          
            0
          
        
      
    
    {\displaystyle f_{0}}
  
は変調周波数を意味する。
受信機では、これら2つの変調した信号はコヒーレント復調器を使うことによって復調できる。
受信した
  
    
      
        I
        (
        t
        )
      
    
    {\displaystyle I(t)}
  
と
  
    
      
        Q
        (
        t
        )
      
    
    {\displaystyle Q(t)}
  
の判断を生成するために、余弦および正弦信号の両方を別々にそれぞれかける。
搬送信号の直交性のために、変調信号を独立して検出することが可能である。
理想的な場合、
  
    
      
        I
        (
        t
        )
      
    
    {\displaystyle I(t)}
  
は送信信号に余弦信号を掛けることにより復調される:

  
    
      
        
          
            
              
                
                  r
                  
                    i
                  
                
                (
                t
                )
                =
              
              
                s
                (
                t
                )
                cos
                ⁡
                (
                2
                π
                
                  f
                  
                    0
                  
                
                t
                )
              
            
            
              
                =
              
              
                I
                (
                t
                )
                cos
                ⁡
                (
                2
                π
                
                  f
                  
                    0
                  
                
                t
                )
                cos
                ⁡
                (
                2
                π
                
                  f
                  
                    0
                  
                
                t
                )
                +
                Q
                (
                t
                )
                sin
                ⁡
                (
                2
                π
                
                  f
                  
                    0
                  
                
                t
                )
                cos
                ⁡
                (
                2
                π
                
                  f
                  
                    0
                  
                
                t
                )
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}r_{i}(t)=&s(t)\cos(2\pi f_{0}t)\\=&I(t)\cos(2\pi f_{0}t)\cos(2\pi f_{0}t)+Q(t)\sin(2\pi f_{0}t)\cos(2\pi f_{0}t)\end{aligned}}}
  

標準的な三角恒等式を使用して、以下のように書き直せる: 

  
    
      
        
          
            
              
                
                  r
                  
                    i
                  
                
                (
                t
                )
                =
              
              
                
                  
                    1
                    2
                  
                
                I
                (
                t
                )
                
                  [
                  
                    1
                    +
                    cos
                    ⁡
                    (
                    4
                    π
                    
                      f
                      
                        0
                      
                    
                    t
                    )
                  
                  ]
                
                +
                
                  
                    1
                    2
                  
                
                Q
                (
                t
                )
                sin
                ⁡
                (
                4
                π
                
                  f
                  
                    0
                  
                
                t
                )
              
            
            
              
                =
              
              
                
                  
                    1
                    2
                  
                
                I
                (
                t
                )
                +
                
                  
                    1
                    2
                  
                
                [
                I
                (
                t
                )
                cos
                ⁡
                (
                4
                π
                
                  f
                  
                    0
                  
                
                t
                )
                +
                Q
                (
                t
                )
                sin
                ⁡
                (
                4
                π
                
                  f
                  
                    0
                  
                
                t
                )
                ]
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}r_{i}(t)=&{\frac {1}{2}}I(t)\left[1+\cos(4\pi f_{0}t)\right]+{\frac {1}{2}}Q(t)\sin(4\pi f_{0}t)\\=&{\frac {1}{2}}I(t)+{\frac {1}{2}}[I(t)\cos(4\pi f_{0}t)+Q(t)\sin(4\pi f_{0}t)]\end{aligned}}}
  

ローパスフィルタ
  
    
      
        
          r
          
            i
          
        
        (
        t
        )
      
    
    {\displaystyle r_{i}(t)}
  
は高い周波数成分（
  
    
      
        4
        π
        
          f
          
            0
          
        
        t
      
    
    {\displaystyle 4\pi f_{0}t}
  
を含む）を取り除き、
  
    
      
        I
        (
        t
        )
      
    
    {\displaystyle I(t)}
  
成分だけ残すことができる。
このフィルターに通された信号は
  
    
      
        Q
        (
        t
        )
      
    
    {\displaystyle Q(t)}
  
の影響を受けない、これは同相成分は直角位相成分の独立性を受け取ることができる事を示す。
同様に、
  
    
      
        Q
        (
        t
        )
      
    
    {\displaystyle Q(t)}
  
を取り出すために、正弦波を掛け合わせてローパスフィルタを使う。
ここで、受信機において受信信号の位相がわかっている事に、注意しなければならない。
もし復調した信号の位相が少しでもずれていれば、変調信号どうしが妨害源になる。
受信機における搬送波の同期のこの問題は、QAMシステムにおいてはどうかして扱わなければならない。
コヒーレント復調器は正確に受信信号と同期している必要がある、そうでなければ変調信号は独立して受信することができない。
たとえば、アナログ・テレビジョン方式は、参照のための各水平同期パルスの後に送信する色搬送波を伝達する。
アナログQAMはNTSCとPALテレビジョン方式で使われており、IおよびQ信号は彩度（色）情報の構成要素を伝達する。
C-QAM（英語: compatible QAM）はAMステレオラジオに使われており、ステレオ差信号を搬送している。

QAMのフーリエ解析
周波数領域において、QAMはDSB-SC変調と似たようなスペクトルパターンを持っている。
フーリエ変換を用いて、以下のことがわかる。

  
    
      
        S
        (
        f
        )
        =
        
          
            1
            2
          
        
        
          [
          
            
              M
              
                I
              
            
            (
            f
            −
            
              f
              
                0
              
            
            )
            +
            
              M
              
                I
              
            
            (
            f
            +
            
              f
              
                0
              
            
            )
          
          ]
        
        +
        
          
            1
            
              2
              j
            
          
        
        
          [
          
            
              M
              
                Q
              
            
            (
            f
            −
            
              f
              
                0
              
            
            )
            +
            
              M
              
                Q
              
            
            (
            f
            +
            
              f
              
                0
              
            
            )
          
          ]
        
      
    
    {\displaystyle S(f)={\frac {1}{2}}\left[M_{I}(f-f_{0})+M_{I}(f+f_{0})\right]+{\frac {1}{2j}}\left[M_{Q}(f-f_{0})+M_{Q}(f+f_{0})\right]}
  

S(f), MI(f) そして MQ(f) は、それぞれs(t), I(t) そして Q(t)のフーリエ変換を意味する。

量子化されたQAM
多くのデジタル変調方式と同様に、信号空間ダイヤグラム（コンスタレーション）は役に立つ。QAM変調の場合、通常信号点は等しい垂直と水平の間隔で正方形の格子に配置される、しかしその他の構成も可能である（例えば Cross-QAM）。
デジタル電気通信において、データは通常バイナリであるので、格子の点の数は通常2の累乗である（2,4,8,16...）。QAM変調は通常四角形である（但し、後述の128QAMはnon-square QAM、すなわち正方形ではない）。最も一般的な形は、16QAM、64QAM、128QAMそして256QAMである。
高次モードに移行することで、1シンボルあたりのビットを多く伝送することができる。しかしながら、信号点の平均電力が同じの場合（公平に比較するため）、信号点はより接近することになり、雑音およびその他の妨害により弱くなり、結果として符号誤り率が高くなる。そのため信号点の平均電力が同じであれば、高次QAMは低次QAMに比べて低い信頼性で多くのデータを伝送することができる。別の言い方をすると、高次のQAMは信号点が多く確保でき伝送速度向上に資するものの、信号点距離は短くなる。これは干渉が生じやすくなり符号誤り率が高まることになる。
8PSKが提供するより、16PSK以上の高いデータ信号速度が必要なときには、QAMは信号点をより均一に割り当てるためにI-Q平面上で近傍の点との距離をより確保できるので、QAMに移行するのが一般的である。
複雑にしている要因は、信号点が全て同じ振幅というわけではなくなるということである。これにより復調器は位相のみならず、位相と振幅を正しく検出しなければならなくなる。
64QAMと256QAMが、デジタルケーブルテレビやケーブルモデムアプリケーションでしばしば使われる。米国では、ANSI/SCTE 07 2000においてSCTEによって標準化され、64QAMと256QAMがデジタルケーブルの指定された変調方式である。
移動体通信において、LTE-Advancedでは256QAMが商用化されている。次世代の5Gでは、下り方向（ダウンリンク）で1024QAMの実装が検討されている。
英国では、16QAMと64QAMが、地上デジタルテレビジョン放送に使われている。(Freeview 及び Top Up TV)。
更に情報の高度化に対応するため、地上波における4K 8Kテレビ放送の試みとして、1024QAMならびに4096QAMでの伝送がNHK放送技術研究所などで開発・公開実験がされているほか、近年開局した4K・8K衛星放送の再送信等によりチャンネル数が逼迫しているケーブルテレビへの採用も検討されている。更に有線での用途では、アメリカ合衆国とカナダではケーブルテレビ用途では(オプション扱いではあるが)16384QAMも規格化され、これらの国のADSL回線には32768QAMを用いる物もある。

理想的な構造
送信機
以下の図はQAM送信機の理想的な構造を示しており、
  
    
      
        
          f
          
            0
          
        
      
    
    {\displaystyle f_{0}}
  
は搬送波周波数、
  
    
      
        
          H
          
            t
          
        
      
    
    {\displaystyle H_{t}}
  
は送信機のフィルタの周波数特性である:

最初に、送信するビットは2つに分けられる、このプロセスで送信する2つの独立した信号を生み出す。それぞれ別々に、振幅偏移変調(ASK)変調で、符号化する。
一方のチャネルが余弦波で乗法するのに対し（同相成分）、他方のチャネルは正弦波で乗法する（直角位相成分）。このようにして、それぞれの信号の間は90度の位相が保たれる。
送信信号は以下の式で表せる:

  
    
      
        s
        (
        t
        )
        =
        
          ∑
          
            n
            =
            −
            ∞
          
          
            ∞
          
        
        
          [
          
            
              v
              
                c
              
            
            [
            n
            ]
            ⋅
            
              h
              
                t
              
            
            (
            t
            −
            n
            
              T
              
                s
              
            
            )
            cos
            ⁡
            (
            2
            π
            
              f
              
                0
              
            
            t
            )
            −
            
              v
              
                s
              
            
            [
            n
            ]
            ⋅
            
              h
              
                t
              
            
            (
            t
            −
            n
            
              T
              
                s
              
            
            )
            sin
            ⁡
            (
            2
            π
            
              f
              
                0
              
            
            t
            )
          
          ]
        
        ,
      
    
    {\displaystyle s(t)=\sum _{n=-\infty }^{\infty }\left[v_{c}[n]\cdot h_{t}(t-nT_{s})\cos(2\pi f_{0}t)-v_{s}[n]\cdot h_{t}(t-nT_{s})\sin(2\pi f_{0}t)\right],}
  

ここで
  
    
      
        
          v
          
            c
          
        
        [
        n
        ]
      
    
    {\displaystyle v_{c}[n]}
  
 と 
  
    
      
        
          v
          
            s
          
        
        [
        n
        ]
      
    
    {\displaystyle v_{s}[n]}
  
の電圧 は、それぞれ第n番目のシンボルに応じて余弦波と正弦波に適用される。

受信機
受信機は、単純に送信機と逆のプロセスを行う。理想的な構造は、下記の図に示しており、
  
    
      
        
          H
          
            r
          
        
      
    
    {\displaystyle H_{r}}
  
は受信機のフィルタの周波数特性である:

余弦波または正弦波を乗法し、低域通過フィルタを通すことによって、同相成分と直角位相成分を抽出する構成が可能となる。その後ろにASK復調器があり、そして2つの信号が合成される。
実際には、送信機と受信機の間に未知の位相遅れがあり、受信機のローカルオシレータ（すなわち上数式の正弦および余弦関数）による同期によって補償されなければならない。
モバイル分野では同様に、送信機と受信機の相対的な速さと比例したドップラー・シフトの存在の可能性があるため、オフセットが相対度数でしばしばある。
伝送路によって変形させられる位相と周波数の変形は、位相の参照を必要とする正弦波と余弦波を構成する要素で調整することによって、きちんと補償されなければならず、位相同期回路（PLL）を使って典型的に達成される。

量子化されたQAMパフォーマンス
誤り率を測定するにあたり、以下のように定義する:

  
    
      
        M
      
    
    {\displaystyle M}
  
   = シンボルの数

  
    
      
        
          E
          
            b
          
        
      
    
    {\displaystyle E_{b}}
  
 = 1ビットあたりの電力

  
    
      
        
          E
          
            s
          
        
      
    
    {\displaystyle E_{s}}
  
 = 1シンボルあたりの電力 = 
  
    
      
        k
        
          E
          
            b
          
        
      
    
    {\displaystyle kE_{b}}
  
（1シンボルあたりがk ビット）

  
    
      
        
          N
          
            0
          
        
      
    
    {\displaystyle N_{0}}
  
 = ノイズ電力スペクトル密度( W / Hz )

  
    
      
        
          P
          
            b
          
        
      
    
    {\displaystyle P_{b}}
  
   = ビット誤り率（BER: Bit Error Rate）

  
    
      
        
          P
          
            b
            c
          
        
      
    
    {\displaystyle P_{bc}}
  
 = 1搬送波あたりのビット誤り率

  
    
      
        
          P
          
            s
          
        
      
    
    {\displaystyle P_{s}}
  
   = シンボル誤り率（SER: Symbol Error Rate）

  
    
      
        
          P
          
            s
            c
          
        
      
    
    {\displaystyle P_{sc}}
  
 = 1搬送波あたりのシンボル誤り率

  
    
      
        Q
        (
        x
        )
        =
        
          
            1
            
              2
              π
            
          
        
        
          ∫
          
            x
          
          
            ∞
          
        
        
          e
          
            −
            
              t
              
                2
              
            
            
              /
            
            2
          
        
        d
        t
        ,
         
        x
        ≥
        

        
        0
      
    
    {\displaystyle Q(x)={\frac {1}{\sqrt {2\pi }}}\int _{x}^{\infty }e^{-t^{2}/2}dt,\ x\geq {}0}
  
.

  
    
      
        Q
        (
        x
        )
      
    
    {\displaystyle Q(x)}
  
は以下の相補誤差関数に関連する: 

  
    
      
        Q
        (
        x
        )
        =
        
          
            1
            2
          
        
        erfc
        ⁡
        
          (
          
            
              x
              
                2
              
            
          
          )
        
      
    
    {\displaystyle Q(x)={\frac {1}{2}}\operatorname {erfc} \left({\frac {x}{\sqrt {2}}}\right)}
  
,
誤り率は、加法的白色ガウス雑音 が引用される。

Rectangular QAM
シンボル誤り率は以下の式で定義される

  
    
      
        
          P
          
            s
            c
          
        
        =
        2
        
          (
          
            1
            −
            
              
                1
                
                  M
                
              
            
          
          )
        
        Q
        
          (
          
            
              
                
                  3
                  
                    M
                    −
                    1
                  
                
              
              
                
                  
                    E
                    
                      s
                    
                  
                  
                    N
                    
                      0
                    
                  
                
              
            
          
          )
        
      
    
    {\displaystyle P_{sc}=2\left(1-{\frac {1}{\sqrt {M}}}\right)Q\left({\sqrt {{\frac {3}{M-1}}{\frac {E_{s}}{N_{0}}}}}\right)}
  
,
ここで
  
    
      
        
        
          P
          
            s
          
        
      
    
    {\displaystyle \,P_{s}}
  
は、

  
    
      
        
        
          P
          
            s
          
        
        =
        1
        −
        
          
            (
            
              1
              −
              
                P
                
                  s
                  c
                
              
            
            )
          
          
            2
          
        
      
    
    {\displaystyle \,P_{s}=1-\left(1-P_{sc}\right)^{2}}
  
.
ビット誤り率は以下の式で定義される

  
    
      
        
          P
          
            b
            c
          
        
        =
        
          
            4
            k
          
        
        
          (
          
            1
            −
            
              
                1
                
                  M
                
              
            
          
          )
        
        Q
        
          (
          
            
              
                
                  
                    3
                    k
                  
                  
                    M
                    −
                    1
                  
                
              
              
                
                  
                    E
                    
                      b
                    
                  
                  
                    N
                    
                      0
                    
                  
                
              
            
          
          )
        
      
    
    {\displaystyle P_{bc}={\frac {4}{k}}\left(1-{\frac {1}{\sqrt {M}}}\right)Q\left({\sqrt {{\frac {3k}{M-1}}{\frac {E_{b}}{N_{0}}}}}\right)}
  
,
ここで
  
    
      
        
        
          P
          
            b
          
        
      
    
    {\displaystyle \,P_{b}}
  
は、

  
    
      
        
        
          P
          
            b
          
        
        =
        1
        −
        
          
            (
            
              1
              −
              
                P
                
                  b
                  c
                
              
            
            )
          
          
            2
          
        
      
    
    {\displaystyle \,P_{b}=1-\left(1-P_{bc}\right)^{2}}
  
.

脚注
関連項目
変調方式 - 信号空間ダイヤグラム
日本の地上デジタルテレビ放送 - ISDB
QPSK

外部リンク
超小型衛星「ほどよし4号」が50 kg級衛星として世界最高速となる毎秒348メガビットの高速ダウンリンク通信に成功 2015年2月18日　東京大学
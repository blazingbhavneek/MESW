# コムフィルタ

コムフィルタ（英: comb filter）は、信号にそれ自身を遅延させたものを追加することで干渉を生じさせるフィルタ回路の一種である。くし形フィルタまたはくし型フィルタとも。コムフィルタの周波数特性は一定間隔のスパイク状になり、図示すると櫛のように見える。

用途
コムフィルタは様々な信号処理に利用されている。

CICフィルタ（カスケード積分コムフィルタ）は、サンプリング周波数変換の際のアンチエイリアスによく使う。
2次元および3次元のコムフィルタは、PALおよびNTSCのテレビデコーダに使う。映像ノイズを低減させる効果がある。
エコー、フランジャー、場合により疑似ステレオといった音響効果。
デジタルウェーブガイド合成などの物理モデル音源。例えば、遅延を数ミリ秒に設定すると、コムフィルタを使って円筒形の空洞や振動する紐などの音響定常波をモデル化できる。

技術的解説
コムフィルタにはフィードフォワード型とフィードバック型がある。これらの名称は追加する信号を遅延させる方向に対応している。
コムフィルタは、離散信号でも連続信号でも実装できる。ここでは主に離散信号での実装を解説する。連続信号用コムフィルタも特性はよく似ている。

フィードフォワード型
フィードフォワード型コムフィルタの大まかな構造を右図に示す。これは次の式で表せる。

ここで、
  
    
      
        K
      
    
    {\displaystyle K}
  
 は遅延長（標本数）、
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 は遅延信号に適用する倍率である。この式の両辺のZ変換を行うと、次の式が得られる。

伝達関数は次のように定義される。

周波数応答
Z領域で表される離散時間系の周波数応答を得るには、
  
    
      
        z
        =
        
          e
          
            j
            ω
          
        
      
    
    {\displaystyle z=e^{j\omega }}
  
 と置き換える。すると、フィードフォワード型コムフィルタの伝達関数は次のようになる。

オイラーの公式を使うと、周波数応答は次のように表すこともできる。

位相を無視して振幅の周波数特性だけを必要とすることが多い。それは次のように定義できる。

フィードフォワード型コムフィルタでは、これが次のようになる。

  
    
      
        (
        1
        +
        
          α
          
            2
          
        
        )
      
    
    {\displaystyle (1+\alpha ^{2})}
  
 という項は定数であり、残る 
  
    
      
        2
        α
        cos
        ⁡
        (
        ω
        K
        )
      
    
    {\displaystyle 2\alpha \cos(\omega K)}
  
 は周期関数である。したがって、コムフィルタの周波数特性は周期的である。
右の2つの図は様々な 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 の値について、周波数特性の周期性を表したものである。次のような特性が重要である。

応答は周期的に局所最小値に落ち込み（「ノッチ」などと呼ぶ）、周期的に局所最大値になる（これを「ピーク」などと呼ぶ）。
最大と最小は常に 1 から等しい距離にある。

  
    
      
        α
        =
        ±
        1
      
    
    {\displaystyle \alpha =\pm 1}
  
 のとき、最小の振幅がゼロになる。この場合の局所最小値を「ヌル」などと呼ぶ。

  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 が正のときの最大と 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 が負のときの最小は同じ周波数であり、逆も同様である。

極と零点
再びZ領域でのフィードフォワード型コムフィルタの伝達関数を考える。

見ての通り、
  
    
      
        
          z
          
            K
          
        
        =
        −
        α
      
    
    {\displaystyle z^{K}=-\alpha }
  
 のとき分子がゼロになる。つまり、
  
    
      
        K
      
    
    {\displaystyle K}
  
 の解は複素平面上の円周に等間隔で並ぶ。それらが伝達関数の零点である。分母は 
  
    
      
        
          z
          
            K
          
        
        =
        0
      
    
    {\displaystyle z^{K}=0}
  
 のときゼロとなるので、
  
    
      
        K
      
    
    {\displaystyle K}
  
 が一定なら 
  
    
      
        z
        =
        0
      
    
    {\displaystyle z=0}
  
 が極となる。以上から次のような極と零点の図が得られる。

フィードバック型
フィードバック型コムフィルタの大まかな構造を右図に示す。これは次の式で表せる。

  
    
      
        y
      
    
    {\displaystyle y}
  
を含む項を左辺に集め、両辺をZ変換すると次のようになる。

したがって、伝達関数は次のようになる。

周波数応答
フィードバック型コムフィルタのZ領域表現で 
  
    
      
        z
        =
        
          e
          
            j
            ω
          
        
      
    
    {\displaystyle z=e^{j\omega }}
  
 と置き換えると、次の式が得られる。

振幅の周波数特性は次のようになる。

こちらも周期的な特性となっていることを右の2つの図で示す。フィードバック型コムフィルタはフィードフォワード型と次のような点が共通である。

応答は周期的に局所最小値と局所最大値を繰り返す。

  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 が正のときの最大と 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 が負のときの最小は同じ周波数であり、逆も同様である。
しかし、上の式で全ての項が分母にあることから、重要な差異もある。

最大値と最小値は 1 から等しい距離にあるわけではない。

  
    
      
        
          |
        
        α
        
          |
        
      
    
    {\displaystyle |\alpha |}
  
 が 1 未満のときだけ安定である。図を見て分かるとおり 
  
    
      
        
          |
        
        α
        
          |
        
      
    
    {\displaystyle |\alpha |}
  
 が大きくなると、最大値の振幅が急激に増大する。

極と零点
再びZ領域でのフィードバック型コムフィルタの伝達関数を考える。

この場合、分子がゼロになるのは 
  
    
      
        
          z
          
            K
          
        
        =
        0
      
    
    {\displaystyle z^{K}=0}
  
 のときであり、
  
    
      
        K
      
    
    {\displaystyle K}
  
 が固定なら 
  
    
      
        z
        =
        0
      
    
    {\displaystyle z=0}
  
 が零点となる。分母は 
  
    
      
        
          z
          
            K
          
        
        =
        α
      
    
    {\displaystyle z^{K}=\alpha }
  
 のときゼロになる。これには 
  
    
      
        K
      
    
    {\displaystyle K}
  
 個の解があり、複素平面上の円周上に等間隔に並ぶ。それらが伝達関数の極である。以上から次のような極と零点の図が得られる。

連続時間コムフィルタ
コムフィルタは連続信号に対しても実装できる。その場合のフィードフォワード型コムフィルタは次の式で表される。

そして、フィードバック型は次の式で表される。

ここで 
  
    
      
        τ
      
    
    {\displaystyle \tau }
  
 は遅延である（単位は秒）。
これらの周波数特性はそれぞれ次の式になる。

連続信号の場合の特性は離散信号の場合と全く同じである。

関連項目
フィルタ回路
デジタルフィルタ
ノイズリダクション
有限インパルス応答
無限インパルス応答
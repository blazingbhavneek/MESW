# チェビシェフフィルタ

チェビシェフフィルタ（英: Chebyshev filter）は、フィルタの一種で、バターワースフィルタに比べてロールオフが急勾配で、通過帯域にリップル (en) がある場合（第一種）と除去帯域にリップルがある場合（第二種）がある。チェビシェフフィルタは、理想的なフィルタ特性と実装との間で誤差を最小化するという特徴を持つが、通過帯域にリップルがある。その数学的特性がチェビシェフ多項式から導き出されたものであることから、パフヌティ・チェビシェフの名を冠せられている。
チェビシェフフィルタには通過帯域のリップルがつきものであるため、方形波など高調波を含む信号については通過帯域の応答特性、特に群遅延特性が劣るチェビシェフフィルタの使用は難しい。一方、リップルは通過帯域におけるVSWR(電圧定在波比)を保証する作用があるため、他の回路に接続した際にバターワースフィルタなどよりも信号のあばれが少なくなる。
また、特定のフィルタ回路構成を指す用語ではなく、フィルタの応答特性を指す用語であるため、チェビシェフフィルタ特性（あるいはチェビシェフ特性）と呼ぶ場合もある。

第一種チェビシェフフィルタ
これは、最も一般的なチェビシェフフィルタである。利得（振幅）応答を角周波数 
  
    
      
        ω
      
    
    {\displaystyle \omega }
  
 の関数としたとき、n次のローパスフィルタの特性は以下のようになる。

ここで 
  
    
      
        ϵ
      
    
    {\displaystyle \epsilon }
  
 はリップル係数、
  
    
      
        
          ω
          
            0
          
        
      
    
    {\displaystyle \omega _{0}}
  
 は遮断周波数、
  
    
      
        
          T
          
            n
          
        
        (
        )
      
    
    {\displaystyle T_{n}()}
  
 は n次のチェビシェフ多項式である。
通過帯域は等リップル性を示し、そのリップルはリップル係数 
  
    
      
        ϵ
      
    
    {\displaystyle \epsilon }
  
 で決定される。通過帯域ではチェビシェフ多項式は -1 から 1 の範囲で変化し、チェビシェフ多項式の2乗は 0 から 1 の範囲で変化するので、フィルタの利得は最大 G=1 から最小 
  
    
      
        G
        =
        1
        
          /
        
        
          
            1
            +
            
              ϵ
              
                2
              
            
          
        
      
    
    {\displaystyle G=1/{\sqrt {1+\epsilon ^{2}}}}
  
 の間で変化する。遮断周波数 
  
    
      
        
          ω
          
            0
          
        
      
    
    {\displaystyle \omega _{0}}
  
 での利得は 
  
    
      
        1
        
          /
        
        
          
            1
            +
            
              ϵ
              
                2
              
            
          
        
      
    
    {\displaystyle 1/{\sqrt {1+\epsilon ^{2}}}}
  
 だが、そこから落ち込み続けて除去帯域となる。この様子を示したのが右図である。ただし、遮断周波数は一般に −3dBとなる周波数だが、チェビシェフフィルタでは成り立たない。
チェビシェフフィルタの次数は、アナログ回路でフィルタを実装したときのリアクタンス部品（コイルなど）の個数に等しい。
リップルはdBで与えられることが多い。

したがって、
  
    
      
        ϵ
        =
        1
      
    
    {\displaystyle \epsilon =1}
  
 のときリップルは 3dB となる。
複素平面の 
  
    
      
        j
        ω
      
    
    {\displaystyle j\omega }
  
軸上の零点を許せば、除去帯域のリップルが生じる代わりにロールオフがより急勾配になる。しかしこれは除去が不完全になることを意味する。そのようなフィルタを楕円フィルタと呼ぶ。

極と零点
単純化するため、遮断周波数を単位元に等しいとする。チェビシェフフィルタの利得の極 
  
    
      
        (
        
          ω
          
            p
            m
          
        
        )
      
    
    {\displaystyle (\omega _{pm})}
  
 は利得の分母の零点である。複素周波数 s を使うと、次が成り立つ場合である。

  
    
      
        −
        j
        s
        =
        cos
        ⁡
        (
        θ
        )
      
    
    {\displaystyle -js=\cos(\theta )}
  
 と定義し、チェビシェフ多項式の三角関数定義を使うと、次が得られる。

これを 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  
 について解くと

となる。アークコサインの複数の値は整数インデックス m を使って明示される。したがってチェビシェフ利得関数の極は次のようになる。

三角関数と双曲線関数の特性を使うと、これを以下の複素形式で書くことができる。

ここで m=1,2,...n であり、

である。これは 
  
    
      
        
          θ
          
            n
          
        
      
    
    {\displaystyle \theta _{n}}
  
 をパラメータとする方程式と見ることができ、極は s平面上で s=0 を中心とする楕円上に並ぶことがわかる。このとき、実数軸の径の長さは 
  
    
      
        sinh
        ⁡
        (
        
          a
          r
          c
          s
          i
          n
          h
        
        (
        1
        
          /
        
        ϵ
        )
        
          /
        
        n
        )
      
    
    {\displaystyle \sinh(\mathrm {arcsinh} (1/\epsilon )/n)}
  
、虚数軸の径の長さは 
  
    
      
        cosh
        ⁡
        (
        
          a
          r
          c
          s
          i
          n
          h
        
        (
        1
        
          /
        
        ϵ
        )
        
          /
        
        n
        )
      
    
    {\displaystyle \cosh(\mathrm {arcsinh} (1/\epsilon )/n)}
  
 となる。

伝達関数
上記の式で利得 G の極が得られる。それぞれの複素極について、複素共役な極があり、それらの対となる極の符号を反転させた別の極の対も存在する（つまり、実数軸と虚数軸を対称軸として4つの極が対称な位置にある）。伝達関数は安定でなければならないので、その極は利得の極のうち実数部が負のものであり、複素周波数平面の左半分に存在する。伝達関数は次のようになる。

ここで 
  
    
      
        
          s
          
            p
            m
          
          
            −
          
        
      
    
    {\displaystyle s_{pm}^{-}}
  
 は、上述の極の式のうち最初の実数項が負の極だけを意味する。
（次節の図のように）
  
    
      
        ω
      
    
    {\displaystyle \omega }
  
=0 での利得を 1 にするには、伝達関数 H(s) を定数で正規化する必要がある。

群遅延
群遅延は位相を角周波数について微分したものと定義され、信号に含まれる異なる周波数成分の位相差による歪みの尺度である。

左図は ε=0.5 の五次第一種チェビシェフフィルタの利得と群遅延を示したものである。通過帯域では利得にも群遅延にもリップルがあるが、除去帯域にはそれがないことがわかる。

第二種チェビシェフフィルタ
第二種チェビシェフフィルタは逆チェビシェフフィルタとも呼ばれる。第一種と同程度に素早くロールオフさせるにはより多くの部品を必要とするため、あまり使われない。通過帯域にはリップルがないが、除去帯域には等リップル性がある。利得は次の通り。

除去帯域ではチェビシェフ多項式は 0 と 1 の間で振動するため、利得も 0 と

の間で振動する。そして、この最大値となる最小周波数は遮断周波数 
  
    
      
        
          ω
          
            0
          
        
      
    
    {\displaystyle \omega _{0}}
  
 である。したがってパラメータ ε は除去帯域減衰率 γ をdBで表したものと関係し、次の式が成り立つ。

5dB の除去帯域減衰率なら ε = 0.6801、10dB なら ε = 0.3333 である。周波数 fC = ωC/2 π は遮断周波数である。3dB周波数 fH と fC は次のような関係にある。

極と零点
ここでも遮断周波数は単位元に等しいとする。チェビシェフフィルタの利得の極 
  
    
      
        (
        
          ω
          
            p
            m
          
        
        )
      
    
    {\displaystyle (\omega _{pm})}
  
 は利得の分母の零点と等しい。

第二種チェビシェフフィルタの利得の極は第一種フィルタの極の逆数となる。

ここで m=1,2,...,n である。第二種チェビシェフフィルタの零点 
  
    
      
        (
        
          ω
          
            z
            m
          
        
        )
      
    
    {\displaystyle (\omega _{zm})}
  
 は利得の分子がゼロになる点である。

したがって第二種チェビシェフフィルタの零点は、チェビシェフ多項式の零点の逆数となる。

ここで m=1,2,...,n である。

伝達関数
伝達関数は利得関数の左半分の平面にある極で与えられる。また、零点も同じだが多重度は1になる。

群遅延
左図は ε=0.1 の五次第二種チェビシェフフィルタの利得と群遅延を示したものである。利得を見ると除去帯域にリップルがあるが、通過帯域には見られない。

実装
Cauer形
受動回路でローパスのチェビシェフフィルタを実装するには、Cauer形のトポロジーを使う。n次チェビシェフフィルタのコイルとコンデンサの値は以下の式で計算できる。

G1、Gk はコイルとコンデンサの値を意味する。fH は3dB周波数であり、
  
    
      
        
          f
          
            H
          
        
        =
        
          f
          
            C
          
        
        cosh
        ⁡
        
          (
          
            
              
                1
                n
              
            
            
              cosh
              
                −
                1
              
            
            ⁡
            
              
                1
                ϵ
              
            
          
          )
        
      
    
    {\displaystyle f_{H}=f_{C}\cosh \left({\frac {1}{n}}\cosh ^{-1}{\frac {1}{\epsilon }}\right)}
  
 で計算できる。係数 A、Y、β、Ak、Bk は以下の式で計算できる。

ここで RdB は通過帯域のリップルをデシベルで表したものである。

計算された Gk の値は、右図の分流コンデンサか上の線上のコイルの値となる。あるいはコンデンサとコイルを入れ替えた回路でもよい。
例えば

あるいは

となる。
このようにして得られた回路は正規化ローパスフィルタである。これに周波数変換やインピーダンスのスケーリングを施すと、任意の遮断周波数や帯域幅のハイパスフィルタ、バンドパスフィルタ、バンドエリミネーションフィルタが得られる。

デジタルの場合
多くのアナログのチェビシェフフィルタは、双一次変換を施すことでデジタル（離散時間）の再帰型フィルタに変換される。しかし、デジタルフィルタの帯域幅は有限なので、変換されたチェビシェフフィルタの応答特性には歪みが生じる。代替手法として整合Z変換を使えば、応答特性に歪みは生じない。

他の線形フィルタとの比較
下図はチェビシェフフィルタと他のフィルタの利得を示したものである。いずれも五次のフィルタである。

見ての通り、チェビシェフフィルタはバターワースフィルタよりも傾斜が急だが、楕円フィルタほどではない。ただし、リップルは楕円フィルタよりも少ない。

関連項目
ベッセルフィルタ
バターワースフィルタ
楕円フィルタ

脚注


== 参考文献 ==
# 楕円フィルタ

楕円フィルタ（英: Elliptic filter）またはカウアーフィルタ（英: Cauer filter）は、通過帯域と除去帯域で等リップル性（equiripple）を示すフィルタ回路の一種。各帯域のリップル量は個別に調整可能で、リップルの値が同じ同一次数の他のフィルタと比較すると、通過帯域から除去帯域への利得の変化が最も素早い。逆に通過帯域と除去帯域のリップルの個別調整をせず、成分変動に影響されないフィルタとして設計することもある。
除去帯域のリップルをほぼゼロにしたものを第一種チェビシェフフィルタと呼ぶ。通過帯域のリップルをほぼゼロにしたものを第二種チェビシェフフィルタと呼ぶ。両方のリップルをゼロにしたフィルタはバターワースフィルタとなる。
ローパス楕円フィルタの利得を各周波数 ω の関数として表すと次のようになる。

ここで Rn はn次楕円有理関数（チェビシェフ有理関数）、
  
    
      
        
          ω
          
            0
          
        
      
    
    {\displaystyle \omega _{0}}
  
 は遮断周波数、
  
    
      
        ϵ
      
    
    {\displaystyle \epsilon }
  
 はリップル係数、
  
    
      
        ξ
      
    
    {\displaystyle \xi }
  
 は選択係数である。
リップル係数の値で通過帯域のリップルが決まり、リップル係数と選択係数の組み合わせで除去帯域のリップルが決まる。

特性
通過帯域では、楕円有理関数の値はゼロと1の間で変化をする。したがって通過帯域の利得は1と 
  
    
      
        1
        
          /
        
        
          
            1
            +
            
              ϵ
              
                2
              
            
          
        
      
    
    {\displaystyle 1/{\sqrt {1+\epsilon ^{2}}}}
  
 の間で変化する。除去帯域では、楕円有理関数は無限大と以下の識別係数 
  
    
      
        
          L
          
            n
          
        
      
    
    {\displaystyle L_{n}}
  
 の間で変化する。

したがって、除去帯域の利得は0と 
  
    
      
        1
        
          /
        
        
          
            1
            +
            
              ϵ
              
                2
              
            
            
              L
              
                n
              
              
                2
              
            
          
        
      
    
    {\displaystyle 1/{\sqrt {1+\epsilon ^{2}L_{n}^{2}}}}
  
 の間で変化する。

  
    
      
        ξ
        →
        ∞
      
    
    {\displaystyle \xi \rightarrow \infty }
  
 の極限で楕円有理関数はチェビシェフ多項式となるので、フィルタとしてはリップル係数 ε の第一種チェビシェフフィルタとなる。
バターワースフィルタはチェビシェフフィルタの極限形式なので、
  
    
      
        ξ
        →
        ∞
      
    
    {\displaystyle \xi \rightarrow \infty }
  
、
  
    
      
        
          ω
          
            0
          
        
        →
        0
      
    
    {\displaystyle \omega _{0}\rightarrow 0}
  
、
  
    
      
        ϵ
        →
        0
      
    
    {\displaystyle \epsilon \rightarrow 0}
  
 の極限で 
  
    
      
        ϵ
        
        
          R
          
            n
          
        
        (
        ξ
        ,
        1
        
          /
        
        
          ω
          
            0
          
        
        )
        =
        1
      
    
    {\displaystyle \epsilon \,R_{n}(\xi ,1/\omega _{0})=1}
  
 となるようにすると、バターワースフィルタになる。

  
    
      
        ξ
        →
        ∞
      
    
    {\displaystyle \xi \rightarrow \infty }
  
、
  
    
      
        ϵ
        →
        0
      
    
    {\displaystyle \epsilon \rightarrow 0}
  
、
  
    
      
        
          ω
          
            0
          
        
        →
        0
      
    
    {\displaystyle \omega _{0}\rightarrow 0}
  
 の極限で 
  
    
      
        ξ
        
          ω
          
            0
          
        
        =
        1
      
    
    {\displaystyle \xi \omega _{0}=1}
  
 かつ 
  
    
      
        ϵ
        
          L
          
            n
          
        
        =
        α
      
    
    {\displaystyle \epsilon L_{n}=\alpha }
  
 となるようにすれば、第二種チェビシェフフィルタとなり、その利得は

となる。

極と零点
楕円フィルタの利得の零点は楕円有理関数の極と一致する。
楕円フィルタの利得の極は、第一種チェビシェフフィルタの利得の極とほぼ同じ手法で導出できる。簡単化のため遮断周波数を1にとる。楕円フィルタの利得の極 
  
    
      
        (
        
          ω
          
            p
            m
          
        
        )
      
    
    {\displaystyle (\omega _{pm})}
  
 は利得の分母がゼロとなる点である。いま虚数単位をｊで表して，複素周波数 
  
    
      
        s
        =
        σ
        +
        j
        ω
      
    
    {\displaystyle s=\sigma +j\omega }
  
 を使うと、次が成り立つ場合である。

  
    
      
        −
        j
        s
        =
        
          c
          d
        
        (
        w
        ,
        1
        
          /
        
        ξ
        )
      
    
    {\displaystyle -js=\mathrm {cd} (w,1/\xi )}
  
 と定義し（cd() はヤコビの楕円コサイン関数）、楕円有理関数の媒介変数表示による定義を使うと、次の式が得られる。

ここで 
  
    
      
        K
        =
        K
        (
        1
        
          /
        
        ξ
        )
      
    
    {\displaystyle K=K(1/\xi )}
  
 かつ 
  
    
      
        
          K
          
            n
          
        
        =
        K
        (
        1
        
          /
        
        
          L
          
            n
          
        
        )
      
    
    {\displaystyle K_{n}=K(1/L_{n})}
  
 である。これを w について解くと

となる。cd()の逆関数の複数の値は、整数インデックス m を用いて明示されている。
したがって楕円利得関数の極は次のようになる。

チェビシェフ多項式と同様、これも明示的な複素形式で表現できる。

ここで 
  
    
      
        
          ζ
          
            n
          
        
      
    
    {\displaystyle \zeta _{n}}
  
 は 
  
    
      
        n
        ,
        
        ϵ
      
    
    {\displaystyle n,\,\epsilon }
  
 および 
  
    
      
        ξ
      
    
    {\displaystyle \xi }
  
 の関数で、
  
    
      
        
          x
          
            m
          
        
      
    
    {\displaystyle x_{m}}
  
 は楕円有理関数の零点である。
  
    
      
        
          ζ
          
            n
          
        
      
    
    {\displaystyle \zeta _{n}}
  
 を全ての次数 n について表すには、ヤコビの楕円函数を使う手法があるが、三次程度までなら代数的に表せる。一次および二次の場合には以下のようになる。

ここで

である。
  
    
      
        
          ζ
          
            3
          
        
      
    
    {\displaystyle \zeta _{3}}
  
 の代数的表現はこれらよりもやや複雑である。
楕円有理関数の入れ子特性を利用すると， 
  
    
      
        
          ζ
          
            n
          
        
      
    
    {\displaystyle \zeta _{n}}
  
 のより高次な式を構築できる。

ここで 
  
    
      
        
          L
          
            m
          
        
        =
        
          R
          
            m
          
        
        (
        ξ
        ,
        ξ
        )
      
    
    {\displaystyle L_{m}=R_{m}(\xi ,\xi )}
  
 である。

最小Q値楕円フィルタ
一般に楕円フィルタの特性は、通過帯域のリップル値、除去帯域のリップル値、遮断の急峻度などで表される。それによって使用可能なフィルタ次数の最小値が決定される。また設計時に考慮すべきこととして、電子部品の特性値が利得関数にどの程度影響するかという問題がある。これは伝達関数の極のQ値に反比例する。極のQ値は以下のように定義される。

そしてこれは、利得関数上の極の影響度合いを表す。楕円フィルタでは、次数を固定してリップル係数と選択係数を変化させると、伝達関数の全ての極のQ値を同時に最小化する組み合わせが存在する。

これにより部品の特性のばらつきに最も影響されないフィルタが得られるが、通過帯域と除去帯域のリップルを個別に設定することはできなくなる。このようなフィルタの次数を上げていくと、両帯域のリップルが減少していき、遮断率が高くなる。最小Q値楕円フィルタでリップルも最小化しようとすると、最小Q値でないフィルタよりも次数を高くする必要がある。利得の絶対値を複素周波数平面にプロットすると、前節の図と似たような図が得られるが、極は楕円ではなく真円上に並ぶ。

他の線形フィルタとの比較
下図は楕円フィルタと他のフィルタの利得を示したものである。いずれも五次のフィルタである。

楕円フィルタは他のフィルタよりも急峻だが、全帯域にリップルが生じている。

参考文献
Daniels, Richard W. (1974年). Approximation Methods for Electronic Filter Design. New York: McGraw-Hill. ISBN 0-07-015308-6 
Lutovac, Miroslav D.; Tosic, Dejan V., Evans, Brian L. (2001年) (English). Filter Design for Signal Processing using MATLAB© and Mathematica©. New Jersey, USA: Prentice Hall. ISBN 0-201-36130-2 
Anatol I. Zverev (1967年, 2005年). Handbook of Filter Synthesis, (Chap. 4, Elliptic Functions and Elements of Realization), John Wiley & Sons, ISBN 978-0-471-74942-4 .
渡部和：「線形回路理論」第2版、昭晃堂(電子回路講座 2）(1971年12月)。第5章"フィルタの設計".